<!DOCTYPE html>
<html>

<head>
  <title>Your Website</title>
  <link rel="stylesheet" type="text/css" href="/style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1">

</head>
<body>

  <!-- Include the navbar -->
  <%- include("navbar"); %>


    <!-- Hero Section -->
    <section class="hero-section firstdiv" style="background-image: url('back.jpg');">
      <!-- <button>Apply Now</button> -->
      <button id="applyNow"type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal">
        Apply Now!
      </button>
    </section>

    <!-- Job Cards Section -->
      <!-- Loop through your job data and generate cards dynamically -->
      <% if (jobs.length > 0){ %>
        <section class="job-cards-section">
          <div class="container">
            <div class="row">
        <% for (let job of jobs) { %>
          <div class="col-12 col-hm-6 col-md-4 col-lg-3 md-4">
              <div class="card job-card d-flex flex-column">
              <div class="card-body">
                <h5 class="card-title"><%= job.jobTitle %></h5>
                <p class="card-text"><%= job.jobDesc %></p>
              </div>
              <ul class="list-group list-group-flush">
                <li class="list-group-item"><strong>Location: </strong><%= job.jobLocation %></li>
                <li class="list-group-item"><strong>Experience: </strong><%= job.Experience %></li>
                <li class="list-group-item"><strong>Other Info: </strong><%= job.other %></li>
              </ul>
            <!-- Add more job details as needed -->
          </div>
        </div>
          <% } %>
        </div>
        </div>
        </section>
        <% } else { %>
          <section class="job-cards-section container justify-content-center">
          <div class="card job-card" style="width: 18rem;">
            <div class="card-body">
              <h5 class="card-title">Currently No Openings</h5>
            </div>
          </div>
        </section>
         <% } %> 

    <!-- About Us Section -->
    <section class="about-us-section">
      <h2 id="about">About Us</h2>
      <!-- <p>Your website's description goes here.</p> -->
      <p>
        Welcome to our website! We are dedicated to providing the best services and solutions for our clients.
        Our team of professionals works tirelessly to achieve excellence in every aspect of what we do.
        Learn more about us and discover how we can help you succeed.
      </p>
    </section>

    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
      aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Your Company Name</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="applyForm" method="POST">
              <div class="form-group">
                <label for="Name">Full Name</label>
                <input type="input" class="form-control" id="Name" name="Name" placeholder="Full Name" required>
                <span class="error-message" id="Name-error"></span>
              </div>
              <div class="form-group">
                <label for="Email1">Email address</label>
                <input type="email" class="form-control" id="Email1" name="Email1" aria-describedby="emailHelp"
                  placeholder="Enter email" required>
                <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone
                  else.</small>
                  <span class="error-message" id="Email1-error"></span>
              </div>
              <div class="form-group">
                <label for="Phone">Phone</label>
                <input type="number" class="form-control" id="Phone" name="Phone" placeholder="Phone" required>
                <span class="error-message" id="Phone-error"></span>
              </div>
              <div class="form-group">
                <label for="Age">Age</label>
                <input type="number" class="form-control" id="Age" name="Age" placeholder="Age" required>
                <span class="error-message" id="Age-error"></span>
              </div>
              <div class="form-group">
                <label for="City">City</label>
                <input type="text" class="form-control" id="City" name="City" placeholder="City" required>
                <span class="error-message" id="City-error"></span>
              </div>
              <div class="form-group">
                <label for="Resume">Upload Resume here</label>
                <input type="file" class="form-control-file" name="Resume" id="Resume" required>
                <span class="error-message" id="Resume-error"></span>
              </div>
              <div id="errorApplyForm">
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary" id="saveUser">Save Application</button>
          </div>
        </div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.min.js"></script>
    <!-- code for post ajax call to save user application form -->
    <script>
      // code for ajax call to save data
      const saveButton = document.getElementById("saveUser");
      saveButton.addEventListener("click", function () {

        // Reset error messages and styles
    $('.error-message').text('');
    $('input').removeClass('error');
        // Check each input field for empty values
    var valid = true;
    
    $('input').each(function() {
      if ($(this).val() === '') {
        valid = false;
        $(this).addClass('error');
        var fieldName = $(this).attr('name');
        $('#' + fieldName + '-error').html('<span style="color:red;font-size:75%;font-style:italic;">This Field is required.</span>');
      }
    })
    
    if (valid) {
      const data = {
          "name": $("#Name").val(),
          "age": $("#Age").val(),
          "email": $("#Email1").val(),
          // "resume":$("#exampleFormResume").val(),
          "city": $("#City").val(),
          "number": $("#Phone").val()
        };
        $.ajax({
          url: "/user",
          type: "POST",
          data: JSON.stringify(data),
          contentType: "application/json",
          success: function (response) {
            $("#myModal").modal("hide");
            document.getElementById("applyForm").reset();
            alert("Application Submitted Successfully");
          },
          error: function (error) {
            resultDiv.html("AJAX request failed.");
          }
        });
    } else {
      // Some fields are empty
      alert("Please fill in all the required fields.");
    }
});

const applyButton = document.getElementById("applyNow");
applyButton.addEventListener("click", function () { 
  $('.error-message').text('');
  document.getElementById("applyForm").reset();
  })     
    </script>

    <!-- Include the footer -->
    <%- include("footer"); %>

</body>

</html>